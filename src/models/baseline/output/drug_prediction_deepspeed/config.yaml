model_name_or_path: /data1/nuist_llm/TrainLLM/ModelCkpt/glm/glm4-8b-chat
output_dir: /data/lzm/DrugRecommend/src/models/baseline/output/drug_prediction_deepspeed
train_file: /data/lzm/DrugRecommend/src/models/baseline/dataset/train.jsonl
task_name: drug-glm4-8b-lora
task_dataset_name: drug-train-80precent
task_des: not des
train_type: A
num_train_epochs: 2
per_device_train_batch_size: 1
gradient_accumulation_steps: 2
learning_rate: 1.0e-05
max_seq_length: 2000
logging_steps: 50
save_steps: 200
save_total_limit: 3
lr_scheduler_type: constant_with_warmup
warmup_steps: 100
lora_rank: 8
lora_alpha: 16
lora_dropout: 0.1
local_rank: 1
distributed: true
gradient_checkpointing: false
optim: adamw_torch
train_mode: lora
seed: 42
fp16: false
report_to: null
dataloader_num_workers: 0
save_strategy: steps
weight_decay: 0
max_grad_norm: 1
remove_unused_columns: true
drug_file: /data/lzm/DrugRecommend/src/models/baseline/dataset/pre_drug.json
use_focal_loss: true
focal_alpha: 0.75
focal_gamma: 2.0
num_neg_samples: 50
model_type: glm
use_lora: true
eval_file: null
eval_steps: 500
eval_ratio: 0.2
evaluation_strategy: steps
metric_for_best_model: best_score
load_best_model_at_end: false
greater_is_better: true
dataloader_pin_memory: true
dataloader_drop_last: true
use_fsdp: false
fsdp_sharding_strategy: FULL_SHARD
fsdp_offload_params: false
fsdp_min_num_params: 100000000.0
fsdp_backward_prefetch: BACKWARD_PRE
fsdp_forward_prefetch: false
use_deepspeed: true
deepspeed_config: /data/lzm/DrugRecommend/src/models/baseline/zero3.json
num_drug: 651
